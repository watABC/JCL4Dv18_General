  //JCL_tbl_ExportTable
  //20130430 yabe
  //一つのテーブルとそのフィールド書き出し

C_TIME($1;$doc)
$doc:=$1
C_TEXT($2;$tableName)
$tableName:=$2
C_POINTER($3;$inAryFieldName)
$inAryFieldName:=$3
C_POINTER($4;$inAryFieldType)
$inAryFieldType:=$4
C_POINTER($5;$inAryFieldLength)
$inAryFieldLength:=$5
C_POINTER($6;$inAryFieldIndex)
$inAryFieldIndex:=$6

C_TEXT($tablePrefix)
C_LONGINT($i;$numOfFields)

$tablePrefix:=JCL_tbl_Prefix ($inAryFieldName)
$numOfFields:=Size of array($inAryFieldName->)

SEND PACKET($doc;$tableName+Char(Tab))
SEND PACKET($doc;$tablePrefix+Char(Carriage return))

For ($i;1;$numOfFields)
	
	$exportFieldName:=Replace string($inAryFieldName->{$i};$tablePrefix;"";1)
	
	SEND PACKET($doc;$exportFieldName+Char(Tab))
	SEND PACKET($doc;$inAryFieldType->{$i}+Char(Tab))
	SEND PACKET($doc;$inAryFieldLength->{$i}+Char(Tab))
	SEND PACKET($doc;$inAryFieldIndex->{$i}+Char(Carriage return))
	
End for 

  //テーブルの区切り
SEND PACKET($doc;"_"+Char(Carriage return))
