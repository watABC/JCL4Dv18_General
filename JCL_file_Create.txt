  //JCL_file_Create
  //20101210 wat new
  //ファイルを作成する、ドキュメント名を返す

C_TEXT($1;$inExt)
$inExt:=$1  //ファイル拡張子
C_POINTER($2;$outDocPtr)
$outDocPtr:=$2  //ファイル参照番号
C_POINTER($3;$outDocNamePtr)
$outDocNamePtr:=$3  //ファイル名
C_LONGINT($0)
C_TEXT($defaultFileName)
C_TEXT($docName)  //ファイル参照番号
C_TIME($doc)

  //エラーコール
ON ERR CALL("JCL_file_OnErrorCall")

$numofParams:=Count parameters
If ($numofParams>=4)
	C_TEXT($4;$inDocName)
	$inDocName:=$4  //デフォルトファイル名
	
	$defaultFileName:=$inDocName+$inExt
	$docName:=Select document(System folder(Desktop)+"aaa";"txt";"Output file name:";File name entry;$fullPath)
	$doc:=Create document($fullPath;$inExt)
	
Else 
	
	  //ファイル参照番号は引数で返す
	  //Document:=$3->
	$outDocPtr->:=Create document("";$inExt)
	  //空文字を与えるとファイル保存ダイアログが表示される
	
End if 

  //エラーコール終了
ON ERR CALL("")

  //ドキュメント名は引数で返す
$outDocNamePtr->:=Document

  //ダイアログがＯＫされたかは戻り値で返す
$0:=ok
