  //JCL_tbl_import
  //JCL_import_tables
  //20111005 wat
  //20121001 wat rename, 20130429 wat mod
  //外部テキストファイルのフィールド定義を読み込んでテーブル作成
  //20150826 yabe フォーム作成フラグ追加

C_LONGINT($dlg_ok)
C_BLOB($fileBlob)  //読み込んだファイルの内容
C_TEXT($fileText)  //読み込んだファイル
ARRAY TEXT($aryTableName;0)  //テーブル名の配列
ARRAY LONGINT($aryStartLineNr;0)  //テーブル定義始まりの行番号の配列
ARRAY TEXT($aryPrefix;0)  //フィールド名のプリフィックスの配列
ARRAY TEXT($aryFormsFlag;0)  //20150826 フォームを作るかどうかのフラグの配列「フォーム作る」なら作成
C_LONGINT($i;$numOfTables)

  //定義ファイルを選択
$dlg_ok:=JCL_file_SelectFileDlg (->$fileBlob)
If ($dlg_ok=1)
	
	  //読み込んだファイルの内容を4Dの文字セットにエンコード
	$fileText:=Convert to text($fileBlob;"UTF-8")
	
	  //テーブル名の配列を得る
	$numOfTables:=JCL_tbl_Names_fromFile ($fileText;->$aryTableName;->$aryStartLineNr;->$aryPrefix;->$aryFormsFlag)
	For ($i;1;$numOfTables)
		
		  //テーブルを作成
		JCL_tbl_Create_bySQL ($fileText;$aryTableName{$i};$aryStartLineNr{$i};$aryPrefix{$i})
		
		  //インデックスを作成
		JCL_tbl_Index_create ($fileText;$aryTableName{$i};$aryStartLineNr{$i};$aryPrefix{$i})
		
	End for 
	
	C_TEXT($msg)
	$msg:="完了"+Char(Carriage return)
	$msg:=$msg+String($numOfTables)+"個のテーブルを作成しました。"
	ALERT($msg)
	
End if 
